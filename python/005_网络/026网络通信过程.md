```python
Packet Tracer软件

pc---交换机---路由器---交换机---pc
1.设置pc的网关地址。网关和pc同网段
2.设置路由器0和1的地址，就是网关地址

pc---交换机---路由器---路由器---路由器---交换机---pc
1.设置pc的网关地址。网关和pc同网段
2.设置路由器0和1的地址，就是网关地址
3.设置路由器下一个访问的地址（设置两个方向的）
去时
192.168.2.0		# 收到数据的网段
255.255.255.0	
192.168.3.2		# 访问的下路由器ip地址

192.168.2.0		# 收到数据的网段
255.255.255.0	
192.168.4.2		# 访问的下路由器ip地址

回来时 
192.168.1.0		# 收到数据的网段
255.255.255.0	
192.168.4.1		# 访问的下路由器ip地址

192.168.1.0		# 收到数据的网段
255.255.255.0	
192.168.3.1		# 访问的下路由器ip地址

RIP：路由解析协议，路由之间通信的协议，现在基本不是用了
```

集线器hub

```python
集线器和交换机都能连接多台电脑。集线器所有数据都用广播形式发送，容易造成网络拥堵
过时了
```

交换机switch

```python
网络中OSI模型对应7层分发的模型
ping需要知道ip地址和mac地址才能成功

网络层中有很多协议：IP ARP RARP IGMP ICMP
arp协议：根据ip找mac地址，用来获取MAC地址
rarp协议：根据mac找ip地址
icmp协议：用ping命令时使用的协议

mac地址：实际网址、硬件地址、网卡序列号。前6位厂商地址，后6为网卡编号
广播mac：都是F的地址FFFF.FFFF.FFFF
电脑收到数据时，在链路层时判断mac地址，如果是自己的Mmac地址或者广播mac就会接收数据，不是就不接收。链路层收到的数据里有TYPE决定用什么协议。0x806发给ARP协议，0x800发给IP协议

arp有个缓存列表，会保存ip地址和mac地址一段时间。需要重新获取
arp -d	删除缓存的mac和ip
arp -a	显示缓存的mac和ip
--------------------------------------------
交换机：工作过程（学习过程）
1.两台电脑第一次通信时不知到目标的mac地址，需要先获取目标mac地址。
2.先给交换机发送arp，arp里面数据包括目标mac、发送者mac、TYPE等信息。交换机再发送给每个电脑，此时时广播。
3.电脑链路层根据mac地址判断是否接收数据。
4.接收的数据到了网络层，根据里面的target ip判断自己是不是目标。如果不是就不接收，如果是就接收。然后把自己的电脑mac地址用arp发交换机，交换机保存，再发给电脑，就知道了mac地址
5.然后发数据时根据这个mac地址找到目标电脑，数据不是arp，也不是广播了，交换机直接发送个目标电脑
```

网关

```python
网关gateway
实质是一个网络通向其他网络的IP地址，网关的IP地址是具有路由功能的设备的IP地址。

有网络A和网络B，网络A的IP地址范围为“192.168.1.1~192. 168.1.254”，子网掩码为255.255.255.0；网络B的IP地址范围为“192.168.2.1~192.168.2.254”，子网掩码为255.255.255.0。
在没有路由器的情况下，两个网络之间是不能进行TCP/IP通信的，即使是两个网络连接在同一台交换机（或集线器）上，TCP/IP协议也会根据子网掩码（255.255.255.0）判定两个网络中的主机处在不同的网络里。

实现这两个网络之间的通信，则必须通过网关。如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机。网络B向网络A转发数据包的过程也是如此。只有设置好网关的IP地址，TCP/IP协议才能实现不同网络之间的相互通信。
--------------------------------------------
默认网关
一台主机可以有多个网关。默认网关的意思是一台主机如果找不到可用的网关，就把数据包发给默认指定的网关，由这个网关来处理数据包。现在主机使用的网关，一般指的是默认网关。
默认网关一般填写192.168.x.1。默认网关必须是电脑自己所在的网段中的IP地址，而不能填写其他网段中的IP地址
发送的ip不在同一网段内，会把这个数据发给默认网关
--------------------------------------------
如何设置默认网关
手动设置：手动设置适用于电脑数量比较少、TCP/IP参数基本不变的情况，比如只有几台到十几台电脑。因为这种方法需要在联入网络的每台电脑上设置“默认网关”，非常费劲，一旦因为迁移等原因导致必须修改默认网关的IP地址，就会给网管带来很大的麻烦，所以不推荐使用。

自动设置：用DHCP服务器来自动给网络中的电脑分配IP地址、子网掩码和默认网关。这样做的好处是一旦网络的默认网关发生了变化时，只要更改了DHCP服务器中默认网关的设置，那么网络中所有的电脑均获得了新的默认网关的IP地址。这种方法适用于网络规模较大、TCP/IP参数有可能变动的网络。
另外一种自动获得网关的办法是通过安装代理服务器软件（如MS Proxy）的客户端程序来自动获得，其原理和方法和DHCP有相似之处
```

路由器

```python
路由器：能连接不同网段
交换机：只能连接同一个网段的电脑
路由器有两个网卡对应两个mac地址 

第一次网络访问时先获取默认网关的mac地址，使用arp
--------------------------------------------
mac和ip联系
mac地址在两个设备之间通信时在变化
ip地址在整个通信过程中不变
上课传纸条，发纸条和最后手指条的人时ip地址始终不变。中间传递的人时mac地址一直在变化。

ip		：标记逻辑上的地址
mac		：标记实际转发数据时的设备地址
network ：和ip地址一起确定网络号
默认网关 ：发送ip不在同一网段内，会把数据发送给默认网关
```

NDS

```python
DNS服务器：用UDP协议，解析域名的协议，保存域名对应的ip地址
域名domain name：ip地址访问不好记
一个服务器可以有多个域名
--------------------------------------------
第一次访问baidu网站的过程
1.确认时候有网关。如果没有不能访问。如果有先获取网关的mac地址，使用arp
2.看电脑时用ip地址还是域名访问的。如果ip访问直接3次握手访问服务器。如果域名访问先解析出ip地址 
	发送数据给默认网关，ip时DNS服务器的，mac地址时默认网关的
    默认网关有转发数据的能力，发数据发给路由器
    路由器根据自己的路由协议，选择较快的路径转发数据给目的网关（DNS服务器所用的网关）
    目的网关把数据发个DNS服务器
    DNS服务器查询解析出对应的ip地址，并把ip地址原路返回给请求这个域名的浏览器
3.得到baidu对应的ip后发送tcp 3次握手进行链接
4.使用http协议发送请求给web服务器 
5.web服务器收到数据后查询结果，原路返回给浏览器
6.浏览器接收数据后渲染显示网页
7.浏览器关闭tcp链接
```

DHCP

```python
DHCP协议：发现局域网中没有ip的电脑并分配ip地址
```

TTL

```python
在ping时

Reply from 192.168.1.2: bytes=32 time=2ms TTL=128
Reply from 192.168.1.2: bytes=32 time=0ms TTL=128
Reply from 192.168.1.2: bytes=32 time=0ms TTL=128
Reply from 192.168.1.2: bytes=32 time=1ms TTL=128

TTL：数据包在网络上经过路由器的最大值。每经过1个路由器-1
如果路由器收到数据的TTL值为0，路由器不会转发数据，而把数据直接扔掉
经过的越多速度月慢 
```

MSL

```python
数据包在网络上存活的最长时间。1~2分钟.如果过期了收到的电脑或路由器会将数据扔掉不接收。
服务器等了MSL时间以后没有收到ack会再次发送FIN数据包。
2MSL：2倍的MSL时间长度
```

家庭网络上网过程

```python
家里的电脑使用私有ip 192.168.1.1等
访问外网时路由器将私有ip转为路由器的公有ip，并分配一个端口号然后访问。
路由器记录共有ip端口对应的私有ip，当路由器收到消息号在发给对应ip的电脑

国外：路由器只用来访问不同网段
国内：路由器、交换机、DHCP功能都有，叫做NAT网络地址转换器

WAN:万维网
LAN：局域网
```

